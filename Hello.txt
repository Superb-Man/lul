1.
SELECT PART_NUMBER, PART_DESCRIPTION
FROM Part
ORDER BY PART_DESCRIPTION ASC;


2.
SELECT CUSTOMER_NUMBER, LAST, FIRST
FROM Customer
WHERE SalesRepNumber IN ('06', '12');


3.
SELECT PART_NUMBER, PART_DESCRIPTION
FROM Part
WHERE ITEM_CLASS <> 'AP'
ORDER BY PART_NUMBER;


4.
SELECT PART_NUMBER, PART_DESCRIPTION, ITEM_CLASS,
       [UNITS_ON_HAND] * [UNIT_PRICE] AS InventoryValue
FROM Part
ORDER BY InventoryValue DESC;


5.
SELECT PART_NUMBER, PART_DESCRIPTION, ITEM_CLASS,
       [UNITS_ON_HAND] * [UNIT_PRICE] AS InventoryValue
FROM Part
WHERE ([UNITS_ON_HAND] * [UNIT_PRICE]) >= 15000
ORDER BY ITEM_CLASS ASC, PART_NUMBER ASC;


6.
SELECT COUNT(*) AS CountWithinLimit
FROM Customer
WHERE BALANCE <= CREDIT_LIMIT;


7.
SELECT ITEM_CLASS,
       SUM([UNITS_ON_HAND] * [UNIT_PRICE]) AS TotalInventoryValue
FROM Part
GROUP BY ITEM_CLASS;


8.
SELECT C.CUSTOMER_NUMBER,
       SUM([NUMBER_ORDERED] * [QUOTED_PRICE]) AS TotalOrderValue
FROM Customer AS C
LEFT JOIN (Order AS O
           INNER JOIN OrderLine AS OL
           ON O.ORDER_NUMBER = OL.ORDER_NUMBER)
ON C.CUSTOMER_NUMBER = O.CUSTOMER_NUMBER
GROUP BY C.CUSTOMER_NUMBER
ORDER BY TotalOrderValue DESC;


9.
SELECT 
    CAST(strftime('%Y', O.ORDER_DATE) AS INTEGER) AS OrderYear,
    CAST(strftime('%m', O.ORDER_DATE) AS INTEGER) AS OrderMonth,
    SUM(OL.NUMBER_ORDERED * OL.QUOTED_PRICE) AS TotalValue
FROM Order_ AS O
INNER JOIN OrderLine AS OL
    ON O.ORDER_NUMBER = OL.ORDER_NUMBER
GROUP BY OrderYear, OrderMonth
ORDER BY OrderYear, OrderMonth;


10.
SELECT 
    S.SalesRepNumber, 
    S.LAST AS SalesRepLast,
    C.CUSTOMER_NUMBER,
    SUBSTR(TRIM(C.FIRST), 1, 1) || '. ' || C.LAST AS CustomerName
FROM SalesRep AS S
LEFT JOIN Customer AS C
    ON S.SalesRepNumber = C.SalesRepNumber
ORDER BY S.SalesRepNumber;


11.
SELECT PART_NUMBER, PART_DESCRIPTION, UNIT_PRICE
FROM Part
WHERE UNIT_PRICE >= (SELECT AVG(UNIT_PRICE) FROM Part);


12.
SELECT C.CUSTOMER_NUMBER, C.FIRST, C.LAST,
       SUM(OL.NUMBER_ORDERED * OL.QUOTED_PRICE) AS TotalOrderValue
FROM (Customer AS C
      INNER JOIN Order_ AS O
      ON C.CUSTOMER_NUMBER = O.CUSTOMER_NUMBER)
INNER JOIN OrderLine AS OL
ON O.ORDER_NUMBER = OL.ORDER_NUMBER
WHERE C.CUSTOMER_NUMBER IN (
    SELECT DISTINCT O2.CUSTOMER_NUMBER
    FROM Order_ AS O2
    INNER JOIN OrderLine AS OL2 ON O2.ORDER_NUMBER = OL2.ORDER_NUMBER
    INNER JOIN Part AS P ON OL2.PART_NUMBER = P.PART_NUMBER
    WHERE P.ITEM_CLASS = 'SG'
)
GROUP BY C.CUSTOMER_NUMBER, C.FIRST, C.LAST;


13
Run this first
SELECT CUSTOMER_NUMBER, LAST, FIRST, BALANCE, CREDIT_LIMIT,
       (BALANCE / CREDIT_LIMIT) AS CreditLimitUsed
INTO Q13
FROM Customer
WHERE (BALANCE / CREDIT_LIMIT) >= 0.85;


Then run 
SELECT * FROM Q13




14.
Run this first
INSERT INTO SalesCommissionPayout
      (SalesRepNumber, CommissionRate, SalesYear, SalesMonthNumber, Sales, Commission)
SELECT 
      S.SalesRepNumber,
      S.COMMISSION_RATE,
      CAST(strftime('%Y', O.ORDER_DATE) AS INTEGER) AS SalesYear,
      CAST(strftime('%m', O.ORDER_DATE) AS INTEGER) AS SalesMonthNumber,
      SUM(OL.NUMBER_ORDERED * OL.QUOTED_PRICE) AS Sales,
      SUM(OL.NUMBER_ORDERED * OL.QUOTED_PRICE * S.COMMISSION_RATE) AS Commission
FROM 
      SalesRep AS S
      JOIN Customer AS C ON S.SalesRepNumber = C.SalesRepNumber
      JOIN Order_ AS O ON C.CUSTOMER_NUMBER = O.CUSTOMER_NUMBER
      JOIN OrderLine AS OL ON O.ORDER_NUMBER = OL.ORDER_NUMBER
GROUP BY 
      S.SalesRepNumber, 
      S.COMMISSION_RATE, 
      SalesYear, 
      SalesMonthNumber
ORDER BY 
      SalesYear, 
      SalesMonthNumber;


Then run it again


SELECT * FROM SalesCommissionPayout;
